<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>c360-ingest-api Testing</title>
  <script type="text/javascript">
  !function(t,e){if(void 0===e[t]){e[t]=function(){e[t].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},e[t].clients=[];for(var r=function(t){return function(){return this["_"+t]=this["_"+t]||[],this["_"+t].push(Array.prototype.slice.call(arguments)),this}},s=["collectTags","addRecord","blockEvents","fetchServerCookie","fetchGlobalID","fetchUserSegments","resetUUID","ready","setSignedMode","setAnonymousMode","set","trackEvent","trackPageview","trackClicks","unblockEvents"],c=0;c<s.length;c++){var o=s[c];e[t].prototype[o]=r(o)}var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.treasuredata.com/sdk/4.1/td.min.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i)}}("Treasure",this);
  </script>
  <script>
    var td = new Treasure({
      database: 'xxxxxxxxxx',
      writeKey: 'xxxxxxxxxx',
      host: 'xxxxxxxxxx',
      cdpHost: 'cdp-development.in.treasuredata.com'
    })

    td.setAnonymousMode()

    //td.set('$global', 'td_global_id', 'td_global_id')
    td.set({
      a: 'say a',
      b: 'say b'
    });
    td.trackPageview('pageview_c360', function () {
      console.log('tracked pageview')

      td.fetchGlobalID(function (value) {
        console.log('yay: ', value)
      }, function (msg) {
        console.log(msg)
      })
    })
    td.trackClicks()

    td.trackEvent('track_event', {date_string: (new Date()).toString()}, function () {
      console.log('track event: yay')
    }, function () {
      console.log('track event: nay')
    })

    td.addRecord('add_record', { ramen: 'ラーメン' }, function () {
      console.log('add record: yay')
    }, function () {
      console.log('add record: nay')
    })

    td.fetchUserSegments({
      audienceToken: ['xxxxxxxxxx'],
      keys: {
        city: 'Denver'
      }
    }, function (response) {
      console.log(JSON.stringify(response, null, 2))
    }, function () {
      console.log('user segment: nay')
    }) 
  </script>
</head>
<body>
  
</body>
</html>
